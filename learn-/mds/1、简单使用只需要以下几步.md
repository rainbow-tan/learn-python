# 1、简单使用只需要以下几步

1. 创建线程池对象ThreadPoolExecutor(max_workers=5, thread_name_prefix="MyThread")
2. 提交任务executor.submit(job, "墨玉麒麟")

```python
import random
import threading
import time
from concurrent.futures import ThreadPoolExecutor


def log(msg):
    t = threading.currentThread()
    name = t.name
    ident = t.ident
    print(f"[{ident}][{name}]{msg}")  # 打印线程号和线程名称


def job(name):
    log(f"I am {name} begin")
    time.sleep(random.randint(1, 10))
    log(f"I am {name} end")


def main():
    executor = ThreadPoolExecutor(max_workers=5, thread_name_prefix="MyThread")
    executor.submit(job, "墨玉麒麟")
    executor.submit(job, "张良")
    executor.submit(job, "猴子")
    log("主线程运行中.")
    log("主线程运行中..")
    log("主线程运行中...")


if __name__ == '__main__':
    main()

```

运行

![image-20230328152548467](C:\Users\dell\AppData\Roaming\Typora\typora-user-images\image-20230328152548467.png)

# 2、等待所有线程执行结束

- 通过wait函数等待所有线程执行结束，当然，也可以只等待某些线程
- 如果设置了wait函数的timeout参数，则最多等timeout秒，程序继续执行
- 举个例子
  - 每个任务等10秒，设置timeout=5，则5秒后继续执行主程序
  - 每个任务等10秒，设置timeout=50，则所有任务结束后，即10秒后，继续执行主程序

```python
import datetime
import threading
import time
from concurrent.futures import ThreadPoolExecutor, wait


def log(msg):
    t = threading.currentThread()
    name = t.name
    ident = t.ident
    print(f"[{ident}][{name}]{msg}")  # 打印线程号和线程名称


def job(name):
    log(f"I am {name} begin")
    time.sleep(10)
    log(f"I am {name} end")


def main():
    log(str(datetime.datetime.now()))
    executor = ThreadPoolExecutor(max_workers=5, thread_name_prefix="MyThread")
    t1 = executor.submit(job, "墨玉麒麟")
    t2 = executor.submit(job, "张良")
    t3 = executor.submit(job, "猴子")
    ts = [t1, t2, t3]
    wait(ts)

    log(str(datetime.datetime.now()))
    log("主线程运行中.")
    log("主线程运行中..")
    log("主线程运行中...")


def main2():
    log(str(datetime.datetime.now()))
    executor = ThreadPoolExecutor(max_workers=5, thread_name_prefix="MyThread")
    t1 = executor.submit(job, "墨玉麒麟")
    t2 = executor.submit(job, "张良")
    t3 = executor.submit(job, "猴子")
    ts = [t1, t2, t3]
    wait(ts, timeout=5)

    log(str(datetime.datetime.now()))
    log("主线程运行中.")
    log("主线程运行中..")
    log("主线程运行中...")


def main3():
    log(str(datetime.datetime.now()))
    executor = ThreadPoolExecutor(max_workers=5, thread_name_prefix="MyThread")
    t1 = executor.submit(job, "墨玉麒麟")
    t2 = executor.submit(job, "张良")
    t3 = executor.submit(job, "猴子")
    ts = [t1, t2]
    wait(ts)  # 只等待t1和t2

    log(str(datetime.datetime.now()))
    log("主线程运行中.")
    log("主线程运行中..")
    log("主线程运行中...")


if __name__ == '__main__':
    # main()
    # main2()
    main3()

```